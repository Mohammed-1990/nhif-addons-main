<odoo>
	<data>
			
		<record id="budget_operation_tree_view" model="ir.ui.view">
			<field name="name">Budget Operation Tree Form</field>
			<field name="model">account.budget.operation</field>
			<field name="arch" type="xml">
				<tree>
					<field name="name"/>
					<field name="date"/>
					<field name="operation_type"/>
					<field name="state"/>
				</tree>
			</field>
		</record>



		<record id="budget_operation_form_view" model="ir.ui.view">
			<field name="name">Budget Operation Form Form</field>
			<field name="model">account.budget.operation</field>
			<field name="arch" type="xml">
				<form>
					<header>
						
						<button name="do_confirm" string="Confirm" type="object" states="draft,canceled" class="oe_highlight"/>	
						<button name="do_validate" string="Validate" type="object" states="confirmed" class="oe_highlight"/>	
						<button name="do_cancel" string="Cancel" type="object" states="confirmed,validated" class="oe_highlight"/>	

						<field name="state" widget="statusbar" />

					</header>
					<sheet>
						<div>
							<h1 class="float-right">
								<label for="name" class="oe_edit_only"/><br/>
								<field name="name" required="1" attrs="{'readonly':[('state','!=', 'draft')]}"/>
							</h1>
						</div>
						<group col="4">
							<field name="date" required="1" attrs="{'readonly':[('state','!=', 'draft')]}"/>
							<field name="operation_type" required="1" attrs="{'readonly':[('state','!=', 'draft')]}"/>
						</group>

						<notebook>
							<page string="Details">
								<field name="line_ids"  attrs="{'readonly':[('state','!=', 'draft')]}">
									<tree editable="bottom"  decoration-success="operation_type == 'transfer' and amount &lt; approved_value and amount &gt; 0" decoration-danger="operation_type == 'transfer' and amount &gt; approved_value" >

										<field name="operation_type" invisible="1"/>
										<field name="budget_id" required="1" options="{'no_create':True}"/>
										<field name="budget_item_details_id" required="1" options="{'no_create':True}"/>
										<field name="account_id" required="1" options="{'no_create':True}"/>
										
										<field name="approved_value" attrs="{'column_invisible':[('parent.operation_type','=','addition')]}" string="Remaining Amount in the Account"/>
										
										<field name="to_budget_item_details_id" options="{'no_create':True}" attrs="{'column_invisible':[('parent.operation_type','=','addition')], 'required':[('parent.operation_type','=','transfer')]}"/>



										<field name="to_account_id" options="{'no_create':True}" attrs="{'column_invisible':[('parent.operation_type','=','addition')], 'required':[('parent.operation_type','=','transfer')]}"/>
										

										<field name="amount" required="1" sum="Amount"/>
									</tree>
								</field>
							</page>
						</notebook>
					</sheet>
					<div class="oe_chatter">
						<field name="message_follower_ids" widget="mail_followers"/>
						<field name="activity_ids" widget="mail_activity"/>
						<field name="message_ids" widget="mail_thread"/>
					</div>
				</form>
			</field>
		</record>

		<record id="action_budget_operations" model="ir.actions.act_window">
			<field name="name">Budget Operations</field>
			<field name="res_model">account.budget.operation</field>
			<field name="view_mode">tree,form</field>
		</record>

		<menuitem id="menu_budget_operation" name="Budget Operations" parent="account.menu_finance_entries_management" action="action_budget_operations" sequence="61"/>
	
	</data>
</odoo>
