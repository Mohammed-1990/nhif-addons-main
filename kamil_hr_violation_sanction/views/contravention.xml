<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <data>
    <record model="ir.ui.view" id="contravention_form_view">
      <field name="name">hr.contravention.form</field>
      <field name="model">hr.contravention</field>
      <field name="arch" type="xml">
      <form>
           <header>
              
            <button name="employment_department" type="object" string="Confirm" states="draft" class="oe_highlight"/>

              <button name="hrm_confirm" states="employment_department" string="Human Resource Management" type="object" class="oe_highlight" groups="kamil_hr_security.hr_management_group"/>

              <button name="gm_hr_confirm" states="hrm_confirm" string="General Administration for Human Resources" type="object" class="oe_highlight" groups="kamil_hr_security.hr_general_department_group,kamil_hr_security.hr_head_of_hr_dept_group"/>

               <button name="action_reject" type="object" string="Reject" states="employment_department" class="oe_highlight" groups="kamil_hr_security.hr_management_group"/>

                <button name="action_reject1" type="object" string="Reject" states="hrm_confirm" class="oe_highlight" groups="kamil_hr_security.hr_general_department_group,kamil_hr_security.hr_head_of_hr_dept_group"/>


              <field name="state" widget="statusbar" statusbar_visible="draft,employment_department,hrm_confirm,gm_hr_confirm"/>
          </header>
        <sheet>
          <div>
            <group col="4">
              <h1>
                <field name="name" placeholder="Contravention No"/>
              </h1>
            </group>
            <group col= "4" >
                <field name="employee_no" attrs="{'readonly':[('state','!=','draft')]}"/>
                <field name="employee_id" options="{'no_create':True,'no_open':True,'no_edit':True}" attrs="{'readonly':[('state','!=','draft')]}"/>
                <field name="managment_id" options="{'no_create':True,'no_open':True,'no_edit':True}"/>
                <field name="department_id" options="{'no_create':True,'no_open':True,'no_edit':True}"/>
                <field name="degree_id" options="{'no_create':True,'no_open':True,'no_edit':True}"/>
                <newline/><newline/>
                <field name="date" attrs="{'readonly':[('state','!=','draft')]}"/>
            </group>
          <group>
              <field name= "summary_contravention" attrs="{'readonly':[('state','!=','draft')]}"/>
          </group>
          <group>
            <group>
              <field name= "accounting_type" attrs="{'readonly':[('state','!=','draft')]}"/>
            </group>
          </group>
          <group>
              <field name ="summary_committees" attrs="{'readonly':[('state','!=','draft')]}"/>
          </group>
         
            <group>
              <field name="reason_refuse"/>
            </group>
            <group>
            <group>
              <field name= "type_penalty" attrs="{'readonly':[('state','!=','draft')]}"/>
              <field name="attachment" attrs="{'invisible':[('type_penalty','!=','termination')],'required':[('type_penalty','=','termination')]}"/>
          </group>
        </group>
        
          
  </div>

          <notebook>
              <page string="Attention" attrs="{'invisible':[('type_penalty','!=','warning'),('type_penalty','!=','warning_and_discount')]}">
                <group>
                  <group>
                    <field name="warning_type_id" attrs="{'required':[('type_penalty','in',['warning','warning_and_discount'])],'readonly':[('state','!=','draft')]}" options="{'no_create':True}"/>
                  </group>
                  <group/>
                </group>
                <group>
                <field name="warning_text" attrs="{'readonly':[('state','!=','draft')],'required':[('type_penalty','=','warning_and_discount')]}"/>
              </group>
              </page>
                <page string="Discount" attrs="{'invisible':[('type_penalty','!=','discount'),('type_penalty','!=','warning_and_discount')]}">
                  <group>
                    <group>
                      <field name="type_discount" attrs="{'readonly':[('state','!=','draft')]}"/>
                      <field name="number_of_days" attrs="{'invisible':[('type_discount','!=','salary')],'required':[('type_discount','=','salary')],'readonly':[('state','!=','draft')]}"/>
                      <field name="incentive" attrs="{'invisible':[('type_discount','!=','incentive')],'required':[('type_discount','=','incentive')]}" options="{'no_create':True}"/>
                      <field name="incentive_discount" attrs="{'invisible':[('type_discount','!=','incentive')],'required':[('type_discount','=','incentive')]}" options="{'no_create':True}"/>
                      <field name="days" attrs="{'invisible':[('incentive_discount','!=','by_days')],'required':[('incentive_discount','=','by_days')]}" />
                       <field name="fixed_amount" attrs="{'invisible':[('incentive_discount','!=','fixed_amount')],'required':[('incentive_discount','=','fixed_amount')]}" options="{'no_create':True}"/>
                      <field name="percentage" attrs="{'invisible':[('incentive_discount','!=','percentage')],'required':[('incentive_discount','=','percentage')]}"/>
                    </group>
                    <group>

                    </group>
                  </group>
                  <group col="4">
                    <field name="date_from" attrs="{'invisible':[('type_discount','!=','incentive')],'required':[('type_discount','=','incentive')]}" />
                    <field name="date_to" attrs="{'invisible':[('type_discount','!=','incentive')],'required':[('type_discount','=','incentive')]}" />
                  </group>
                </page>
              
                <page string="Reduce Degree"  attrs="{'invisible':[('type_penalty','!=','reduce_degree')]}">
                  <group col="4">
                    <field name = "current_degree"  readonly="True"   force_save="1"   />
                    <field name ="new_degree" attrs="{'required':[('type_penalty','=','reduce_degree')],'readonly':[('state','!=','draft')]}" options="{'no_create':True}" />
                  </group>
                </page>


          </notebook> 
        </sheet>
        <div class="oe_chatter">
              <field name="message_follower_ids" widget="mail_followers"/>
              <field name="activity_ids" widget="mail_activity"/>
              <field name="message_ids" widget="mail_thread"/>
          </div>
      </form>
    </field>
  </record>

    <record model="ir.ui.view" id="contravention_tree_view">
      <field name="name">hr.contravention.tree</field>
      <field name="model">hr.contravention</field>
      <field name="arch" type="xml">
       <tree>
        <field name="employee_id" />
        <field name="date"/>           
        <field name="degree_id"/>
        <field name= "type_penalty"/>
        <field name= "state"/>
      </tree>
     </field>
    </record>

  <record id="action_contravention" model="ir.actions.act_window">
    <field name="name">Contraventions</field>
    <field name="res_model">hr.contravention</field>
    <field name="view_mode">tree,form</field>
  </record>



  <!-- contravention type tree view -->
    <record model="ir.ui.view" id="contravention_type_tree_view">
      <field name="name">contravention.type.tree</field>
      <field name="model">hr.contravention.type</field>
      <field name="arch" type="xml">
        <tree editable="bottom">
          <field name="name"/>
        </tree>
      </field>
    </record>


    <!-- action contravention type -->
    <record id="action_contravention_type" model="ir.actions.act_window">
      <field name="name">Contravention Types</field>
      <field name="res_model">hr.contravention.type</field> 
      <field name="view_mode">tree</field>
    </record>

 
  <menuitem 
    name="Contraventions" 
    id="contravention_menu"
   action="action_contravention"
   parent="menu_hr_violation_sanction" sequence="1"/>

    <menuitem name="Contravention Types"
            id="contravention_type_menu"
            action="action_contravention_type"
            parent="menu_violation_configuration"
            groups="kamil_hr_security.hr_employment_department_group"
            />

  </data>
</odoo>