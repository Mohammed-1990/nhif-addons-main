<odoo>
    <data>

        <record id="collection_tree_view" model="ir.ui.view">
            <field name="name">Collection Tree</field>
            <field name="model">collection.collection</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="ref"/>
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="state_id"/>
                    <field name="date"/>
                    <field name="operation_type"/>
                    <field name="collector_id"/>
                    <field name="amount" sum="Amount"/>
                    <field name="state"/> 
                    <field name="cancel_e15_state"/>

                    
                </tree>
            </field>
        </record>
        <!--  -->
        <record id="view_collection_collection_search_custom" model="ir.ui.view">
    <field name="name">collection.collection.search.custom</field>
    <field name="model">collection.collection</field>
    <field name="arch" type="xml">
        <search string="collection collection">

            <!-- الحقول اللي يظهر فيها البحث -->
            <field name="ref"/>
            <field name="collector_id"/>
            <field name="collection_type"/>
            

        </search>
    </field>
</record>


        <!--						<button name="do_cancel" string="Cancel" type="object" attrs="{'invisible':[('state','in',['draft','canceled'] )]}"/>-->

        <record id="collection_form_view" model="ir.ui.view">
            <field name="name">Collection Form</field>
            <field name="model">collection.collection</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button name="do_confirm" string="Confirm" type="object" states="draft,returned_to_collector"
                                groups="kamil_accounting_base.collector_group" class="oe_highlight"
                              
                        />

                        <button name="do_audit" string="Audit" type="object" states="internal_auditor_audit"
                                groups="kamil_accounting_base.internal_auditor_group" class="oe_highlight"
                              
                        />

                        <button name="do_return_to_collector" string="Return To Collector" type="object"
                                states="internal_auditor_audit" groups="kamil_accounting_base.internal_auditor_group"
                                class="oe_highlight" 
                        />

                        <button name="do_reset_to_draft" string="Set to Draft" type="object" states="confirmed"
                                class="oe_highlight" 
                        />

                        <field name="state" widget="statusbar"
                               statusbar_visible="draft,confirmed"
                        
                        />

                          <button name="accept_cancel_e15" string="Accept Cancel " type="object" 
                          groups="kamil_accounting_base.supervisor_group" 
                          class="oe_highlight"
                                    attrs="{'invisible': ['|','|','|',
                     ('is_cancel_receipt_e15','=',False),
                     ('is_cancel_accept_e15','=',True),
                     ('is_unlink_cancel_accept_e15','=',True),
                    ('is_reject_cancle_e15','=',True)
                    ]}"/>
                    

                          <button name="cancel_e15" string="Confirm Cancel" type="object" 
                           groups="kamil_accounting_base.collector_group"
                          class="oe_highlight"
                            attrs="{'invisible': ['|','|',
                     ('is_cancel_receipt_e15','=',False),
                     ('is_cancel_accept_e15','=',False),
                     ('is_unlink_cancel_accept_e15','=',True)]}"                        />

                        <button name="request_cancel_e15" string=" Cancel Request" type="object" 
                         groups="kamil_accounting_base.collector_group"
                          class="oe_highlight"
                        attrs="{'invisible': ['|','|',
                     ('is_cancel_receipt_e15','=',False),
                     ('is_cancel_accept_e15','=',True),
                     ('is_unlink_cancel_accept_e15','=',True)]}"
                        />

                         <button name="reject_cancel_e15" string="Reject Cancel" type="object" 
                         groups="kamil_accounting_base.supervisor_group" 
                          class="oe_highlight"
                          attrs="{'invisible': ['|','|','|',
                     ('is_cancel_receipt_e15','=',False),
                     ('is_cancel_accept_e15','=',True),
                     ('is_unlink_cancel_accept_e15','=',True),
                    ('is_reject_cancle_e15','=',True)
                    ]}"/>

                    </header>
                    <sheet>

                        <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button" type="object" name="show_collection_moves" icon="fa-bars"
                                    attrs="{'invisible':[('collection_move_id','=',False)]}">
                                Journal Enteries
                                <field name="collection_move_id" invisible="1"/>
                            </button>
                        </div>

                        <div class="float-right">
                            <h2>
                                <label for="ref"/>
                                <br/>
                                <field name="ref" readonly="1"/>
                            </h2>
                        </div>
                        
                      
                        <group col="4">
                            <field name="partner_id" required="1" options="{'no_create':True,'no_edit':True,'no_open':True}"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="state_id"  required="1" options="{'no_create':True,'no_edit':True,'no_open':True}"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"
                                   string="Branch"/>
                            <field name="date" required="1"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="operation_type" required="1"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="collection_type" required="1" options="{'no_create':True,'no_edit':True,'no_open':True}"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="currency_id"  required="1" options="{'no_create':True,'no_edit':True,'no_open':True}"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="journal_id"  required="1" options="{'no_create':True,'no_edit':True,'no_open':True}"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="is_cancel_receipt_e15" invisible="1"/>
                        </group>
                        <group col="4">
                            <field name="cheque_number" string="Cheque/Transfer No."
                                   attrs="{'invisible':[('collection_type','in',['cash','e_bank'])], 'required':[('collection_type','not in',['cash','e_bank'])],'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="cheque_bank" string="Cheque/Transfer Bank Name"
                                   attrs="{'invisible':[('collection_type','in',['cash','e_bank'])], 'required':[('collection_type','not in',['cash','e_bank'])],'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                        </group>
                         <group col="4">
                            <field name="bank_application_id" string="Application Name."  options="{'no_create':True,'no_edit':True,'no_open':True}"
                                   attrs="{'invisible':[('collection_type','not in',['e_bank'])], 'required':[('collection_type','in',['e_bank'])],'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="account_number" string="Account Number" 
                                   attrs="{'invisible':[('collection_type','not in',['e_bank'])]}" force_save="1" readonly="1"/>
                            <field name="transaction_number" string="transaction Number"
                                   attrs="{'invisible':[('collection_type','not in',['e_bank'])], 'required':[('collection_type','in',['e_bank'])],'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                        </group>

                        <group string="Period" col="4"
                               attrs="{'invisible':[('operation_type','=','other_revenues')],'readonly':[('state','not in',['draft','returned_to_collector'])]}">
                            <field name="subscription_date_from"
                                   attrs="{'required':[('operation_type','!=','other_revenues')],'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                            <field name="subscription_date_to"
                                   attrs="{'required':[('operation_type','!=','other_revenues')],'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>
                        </group>
                        <group col="4">
                            <field name="collector_id"
                                  options="{'no_create':True,'no_edit':True,'no_open':True}"
                                   required="1"
                                   domain="[('is_collector','=',True)]"
                                   readonly="True"/>
                            <field name="collector_account_id" options="{'no_create':True,'no_edit':True,'no_open':True}"  required="1"
                                   readonly="True"/>
                            <field name="e_15_no" invisible="1"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>

                        </group>

                        <group>
                            <field name="name" required="1" placeholder="يجب ان لا يتجاوز الوصف 100 خانة  "
                                   maxlength="100"
                                   attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}"/>

                        </group>

                        <field name="budget_item_ids" invisible="1"/>
                        <group col="4">
                            <field name="amount"/>
                            <field name="amount_in_words"/>
                            <field name ="cancel_e15_state" invisible="1"/>
                        </group>
                        <group>
                        <field name="is_cancel_accept_e15" invisible="1"/>
                        <field name ="is_unlink_cancel_accept_e15" invisible="1"/>
                        <field name ="is_reject_cancle_e15" invisible="1"/>
                        </group>
                        <notebook>
                            <page string="Details">
                                <field name="line_ids"
                                       attrs="{'readonly':[('state','not in',['draft','returned_to_collector'])]}">
                                    <tree editable="bottom">
                                        <field name="branch_id" options="{'no_create':True}" required="1"/>
                                        <field name="account_id" options="{'no_create':True}" required="1"/>
                                        <field name="analytic_account_id" options="{'no_create':True}"/>
                                        <field name="cost_center_id"/>
                                        <field name="analytic_tag_ids" widget="many2many_tags"/>
                                        <field name="amount" required="1" sum="amount"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Cancel Reason">
                            <field name ="cancel_reason" readonly="1"/>
                            </page>
                             <page string="Return Reason">
                            <field name ="returned_reason" readonly="1"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="collection_line_form_view" model="ir.ui.view">
            <field name="name">Collection Line Form</field>
            <field name="model">collection.collection.line</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <field name="branch_id" readonly="1"/>
                            <field name="cost_center_id" readonly="1"/>
                            <field name="analytic_account_id" readonly="1"/>
                            <field name="analytic_tag_ids" widget="many2many_tags" readonly="1"/>
                            <field name="account_id" readonly="1"/>
                            <field name="amount" readonly="1"/>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="action_collection" model="ir.actions.act_window">
            <field name="name">Revenues Collection</field>
            <field name="res_model">collection.collection</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_cancel_collection" model="ir.actions.act_window">
            <field name="name">Revenues Cancel Collection</field>
            <field name="res_model">collection.collection</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_cancel_receipt_e15','=',True)]</field>
        </record>

        <menuitem id="revenues_collection_menu" parent="revenues_collection_main_menu" action="action_collection"
                  sequence="1"/>

        <menuitem id="revenues_cancel_collection_menu" parent="revenues_collection_main_menu"
        groups="kamil_accounting_base.supervisor_group" 
                  action="action_cancel_collection"
                  sequence="1"/>


        <record id="action_partners" model="ir.actions.act_window">
            <field name="name">Partners</field>
            <field name="res_model">res.partner</field>
            <field name="view_mode">kanban,tree,form</field>
        </record>

        <menuitem id="partners_menu" parent="revenues_collection_main_menu" action="action_partners" sequence="100"/>


    </data>
</odoo>
